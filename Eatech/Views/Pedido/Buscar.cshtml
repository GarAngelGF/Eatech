
@{
    ViewData["Title"] = " BuscarAlumnos";
}

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INICIAR</title>
    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- BOOTSTRAP SCRIPT -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- CSS (CAMBIA EN VS)-->
    <!-- --------------------------------------------------------------------------- -->
    <link rel="stylesheet" href="/css/E-INICIO-P.css">
    <!-- --------------------------------------------------------------------------- -->
    <!--FONT AWESOME (ESTILOS DE BOTÓN)-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <!-- FUENTE DE EATECH -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@523&family=Varela+Round&display=swap"
          rel="stylesheet">
    <!-- FUENTE DE TITULOS DE EATECH -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@100;200;300;400;500;600;700;800;900&display=swap"
          rel="stylesheet">

    <!-- CAPTCHA DE GOOGLE -->
    <script src="https://www.google.com/recaptcha/api.js"></script>
</head>

<body>

    <div id="container2" class="content-container">

        <form id="buscarForm">

            <br>
            <br>
            <br>

            <!-- Contenedor de Estudiantes -->
            <div id="estudiantes-contenedor" class="contenedor-estudiantes">


                <h3>Ingresa la matrícula del alumno</h3>

                <input placeholder="matricula" name="AlumnoMatricula" id="AlumnoMatricula" type="search" class="input" required>
                <br><br>
                <button type="submit" class="btn btn-primary">Buscar</button>
                <br><br>
        
 
         
 
           @*  <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-3">
                    <input value="@item.AlumnoNombre" type="text" class="input" readonly>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-2">
                    <input value="@item.FechaPedido" type="text" class="input" readonly>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-2">
                    <input value="@item.FechaEntrega" type="text" class="input" readonly>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-2">
                    <input value="@item.EstatusPedido" type="text" class="input" readonly>
                </div>
            </div>  *@


             

        </form>

        <div id="resultados">
            
        </div>


    </div>
    @section Scripts {
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script>
            $(document).ready(function () {
                $("#buscarForm").on("submit", function (event) {
                    event.preventDefault();
                    var AlumnoMatricula = $("#AlumnoMatricula").val();

                    $.ajax({
                        url: '@Url.Action("Buscar2", "Pedido")',
                        type: 'POST',
                        data: { AlumnoMatricula: AlumnoMatricula },
                        success: function (response) {
                            console.log(response);
                            if (response.success) {
                                var pedidos = response.pedidos;
                                var html = '<h2>Pedidos</h2><table><thead><tr><th>Nombre del Alumno</th><th>Fecha del Pedido</th><th>Fecha de Entrega</th><th>Estatus del Pedido</th></tr></thead><tbody>';

                                $.each(pedidos, function (index, pedido) {
                                    html += '<tr><td>' + pedido.alumnoNombre + '</td><td>' + new Date(pedido.fechaPedido).toLocaleDateString() + '</td><td>' + new Date(pedido.fechaEntregaa).toLocaleDateString() + '</td><td>' + pedido.estatusPedido + '</td></tr>';
                                });

                                html += '</tbody></table>';
                                $("#resultados").html(html);
                            } else {
                                $("#resultados").html('<p>' + response.message + '</p>');
                            }
                        },
                        error: function () {
                            $("#resultados").html('<p>Ocurrió un error al realizar la búsqueda.</p>');
                        }
                    });
                });
            });
        </script>
    }



    @*  <script>
    document.getElementById('buscarForm').addEventListener('submit', function (event) {
    event.preventDefault(); // Evitar el envío del formulario por defecto

    var matricula = document.getElementById('AlumnoMatricula').value.trim();

    // Validar que se haya ingresado la matrícula
    if (!matricula) {
    alert('Por favor ingrese la matrícula del alumno.');
    return;
    }

    // Realizar la petición AJAX para buscar pedidos
    var xhr = new XMLHttpRequest();
    xhr.open('POST', '/Pedidos/Buscar'); // Ajusta la ruta según tu configuración
    xhr.setRequestHeader('Content-Type', 'application/json');

    xhr.onload = function () {
    if (xhr.status === 200) {
    var pedidos = JSON.parse(xhr.responseText);
    mostrarResultados(pedidos);
    } else {
    alert('Error al buscar pedidos.');
    }
    };

    xhr.onerror = function () {
    alert('Error de red al intentar buscar pedidos.');
    };

    // Enviar los datos del formulario como JSON
    var formData = JSON.stringify({ AlumnoMatricula: matricula });
    xhr.send(formData);
    });

    function mostrarResultados(pedidos) {
    var resultadoDiv = document.getElementById('resultadoPedidos');
    resultadoDiv.innerHTML = ''; // Limpiar contenido anterior

    if (pedidos.length === 0) {
    resultadoDiv.innerHTML = '<p>No se encontraron pedidos para esta matrícula de alumno.</p>';
    return;
    }

    var html = '<h3>Resultados de Pedidos</h3><ul>';
    pedidos.forEach(function (pedido) {
    html += '<li>';
    html += '<strong>Alimento:</strong> ' + pedido.AlimentoNombre + '<br>';
    html += '<strong>Fecha de Pedido:</strong> ' + pedido.FechaPedido + '<br>';
    html += '<strong>Fecha de Entrega:</strong> ' + pedido.FechaEntrega + '<br>';
    html += '<strong>Estatus del Pedido:</strong> ' + pedido.EstatusPedido;
    html += '</li>';
    });
    html += '</ul>';

    resultadoDiv.innerHTML = html;
    }
    </script> *@

</body>

</html>
